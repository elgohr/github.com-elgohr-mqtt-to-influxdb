on:
  release:
    types: [created]

name: Attach Binaries
jobs:
  generate:
    name: Create release-artifacts
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the repository
        uses: actions/checkout@v2
      - name: Set up Go 1.13
        uses: actions/setup-go@v2
        with:
          go-version: 1.13
      - name: Build Linux
        run: GOOS=linux GOARCH=amd64 go build -o "out/mqtt-to-influx-linux-amd64" main.go
      - name: Build Raspberry
        run: GOOS=linux GOARCH=arm GOARM=5 go build -o "out/mqtt-to-influx-linux-arm5" main.go
      - uses: AButler/upload-release-assets@v2.0
        with:
          files: 'out/*'
          repo-token: ${{ secrets.GITHUB_TOKEN }}